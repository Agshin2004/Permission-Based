<!DOCTYPE html>
<html>
<body>
<div id="chat"></div>
<input id="msgInput" type="text" placeholder="Type message..."/>
<button onclick="sendMessage()">Send</button>

<script>
    const chatBox = document.getElementById("chat");
    const eventSource = new EventSource("http://localhost:8091/api/chat/stream");
    const username = prompt("Type your username: ");

    eventSource.onmessage = (e) => {
        const msg = JSON.parse(e.data);
        chatBox.innerHTML += `<p><b>${msg.sender}:</b> ${msg.content}</p>`;
    };

    eventSource.addEventListener("Chat", e => {
        const msg = JSON.parse(e.data);
        chatBox.innerHTML += `<p><b>${msg.sender}:</b> ${msg.content}</p>`;
    });

    function sendMessage() {
        const input = document.getElementById("msgInput");
        fetch("http://localhost:8091/api/chat/send", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({sender: username, content: input.value})
        });
        input.value = "";
    }
</script>
</body>
</html>
